<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute the scan test. — scan.test • spqdata</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute the scan test. — scan.test" />
<meta property="og:description" content="This function compute the scan test for Bernoulli and Multinomial categorical spatial process." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spqdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.00</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/user_guide.html">spqdata user guide</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paezha/spqdata/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the scan test.</h1>
    <small class="dont-index">Source: <a href='https://github.com/paezha/spqdata/blob/master/R/scan.test.R'><code>R/scan.test.R</code></a></small>
    <div class="hidden name"><code>scan.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function compute the scan test for Bernoulli and Multinomial categorical spatial process.</p>
    </div>

    <pre class="usage"><span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='cn'>NULL</span>, data <span class='op'>=</span> <span class='cn'>NULL</span>, fx <span class='op'>=</span> <span class='cn'>NULL</span>, coor <span class='op'>=</span> <span class='cn'>NULL</span>, case <span class='op'>=</span> <span class='cn'>NULL</span>, nv <span class='op'>=</span> <span class='cn'>NULL</span>,
nsim <span class='op'>=</span> <span class='cn'>NULL</span>, distr <span class='op'>=</span> <span class='cn'>NULL</span>, windows <span class='op'>=</span> <span class='st'>"circular"</span>, alternative <span class='op'>=</span> <span class='st'>"High"</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of the factor (optional).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an (optional) data frame or a sf object containing the variable to testing for.</p></td>
    </tr>
    <tr>
      <th>fx</th>
      <td><p>a factor (optional).</p></td>
    </tr>
    <tr>
      <th>coor</th>
      <td><p>(optional) coordinates of observations.</p></td>
    </tr>
    <tr>
      <th>case</th>
      <td><p>Only for bernoulli distribution. A element of factor, there are cases and non-cases for testing for cases versus non-cases</p></td>
    </tr>
    <tr>
      <th>nv</th>
      <td><p>Maximum windows size, default nv = N/2. The algorithm scan for clusters of geographic size between 1
and the upper limit (nv) defined by the user.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of permutations.</p></td>
    </tr>
    <tr>
      <th>distr</th>
      <td><p>distribution of the spatial process: "bernoulli" for two levels or "multinomial" for three or more levels.</p></td>
    </tr>
    <tr>
      <th>windows</th>
      <td><p>a string to select the type of cluster "circular" (default) of "elliptic".</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>Only for bernoulli spatial process. A character string specifying the type of cluster, must be one
of "High" (default), "Both" or "Low".</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>List of additional control arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A object of the <em>htest</em> and <em>scantest</em> class</p><table class='table'>
<tr><td><code>method</code></td><td>The type of test applied ().</td></tr>
<tr><td><code>fx</code></td><td>Factor included as input to get the scan test.</td></tr>
<tr><td><code>MLC</code></td><td>Observations included into the Most Likelihood Cluster (MLC).</td></tr>
<tr><td><code>statistic</code></td><td>Value of the scan test (maximum Log-likelihood ratio).</td></tr>
<tr><td><code>N</code></td><td>Total number of observations.</td></tr>
<tr><td><code>nn</code></td><td>Windows used to get the cluster.</td></tr>
<tr><td><code>nv</code></td><td>Maximum number of observations into the cluster.</td></tr>
<tr><td><code>data.name</code></td><td>A character string giving the name of the factor.</td></tr>
<tr><td><code>coor</code></td><td>coordinates.</td></tr>
<tr><td><code>alternative</code></td><td>Only for bernoulli spatial process. A character string describing the alternative hypothesis select by the user.</td></tr>
<tr><td><code>p.value</code></td><td>p-value of the scan test.</td></tr>
<tr><td><code>cases.expect</code></td><td>Expected cases into the MLC.</td></tr>
<tr><td><code>cases.observ</code></td><td>Observed cases into the MLC.</td></tr>
<tr><td><code>nsim</code></td><td>Number of permutations.</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Two alternative sets of arguments can be included in this function to compute the scan test:</p>
<table class='table'>
<tr><td><code>Option 1</code></td><td>A factor (fx) and coordinates (coor).</td></tr>
<tr><td><code>Option 2</code></td><td>A sf object (data) and the formula to specify the factor.
The function consider the coordinates of the centroids of the elements of th sf object.</td></tr>
</table>


<p>The spatial scan statistics are widely used in epidemiology, criminology or ecology.
Their purpose is to analyze the spatial distribution of points or geographical
regions by testing the hypothesis of spatial randomness his distribution on the
basis of different distributions (e.g. Bernoulli, Poisson or Normal distributions).
The <code>scan.test</code> function obtain the scan statistic for the Bernoulli and Multinomial distribution.</p>
<p>To test independence in a spatial process, under the null, the type of windows is irrelevant but under the alternative the elliptic
windows can to identify with more precision the cluster.</p>
<p>For big data sets (N &gt;&gt;) the windows = "elliptic" can be so slowly</p>
    <h2 class="hasAnchor" id="control-arguments"><a class="anchor" href="#control-arguments"></a>Control arguments</h2>

    

<table class='table'>
<tr><td><code>seedinit</code></td><td>Numerical value for the seed (only for boot version). Default value seedinit=123</td></tr>
</table>


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Kulldorff M, Nagarwalla N. (1995).
Spatial disease clusters: Detection and Inference.
<em>Statistics in Medicine</em>. 14:799-810</p></li>
<li><p>Jung I, Kulldorff M, Richard OJ (2010).
A spatial scan statistic for multinomial data.
<em>Statistics in Medicine</em>. 29(18), 1910-1918</p></li>
<li><p>Páez, A., López-Hernández, F. A., Ortega-García, J. A., &amp; Ruiz, M. (2016).
Clustering and co-occurrence of cancer types: A comparison of techniques with an application to pediatric cancer in Murcia, Spain.
<em>Spatial Analysis in Health Geography</em>, 69-90.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='local.sp.runs.test.html'>local.sp.runs.test</a></code>, <code><a href='dgp.spq.html'>dgp.spq</a></code>, <code><a href='Q.test.html'>Q.test</a></code>,</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    
<table class='table'>
<tr><td>Fernando López</td><td><a href='mailto:fernando.lopez@upct.es'>fernando.lopez@upct.es</a></td></tr>
<tr><td>Román Mínguez</td><td><a href='mailto:roman.minguez@uclm.es'>roman.minguez@uclm.es</a></td></tr>
<tr><td>Antonio Páez</td><td><a href='mailto:paezha@gmail.com'>paezha@gmail.com</a></td></tr>
<tr><td>Manuel Ruiz</td><td><a href='mailto:manuel.ruiz@upct.es'>manuel.ruiz@upct.es</a></td></tr>
</table>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Case 1: scan test bernoulli</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span>list <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Spain</span><span class='op'>)</span>
<span class='va'>formula</span> <span class='op'>&lt;-</span> <span class='op'>~</span> <span class='va'>MenWoman</span>
<span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>spain.sf</span>, case<span class='op'>=</span><span class='st'>"men"</span>, nsim <span class='op'>=</span> <span class='fl'>99</span>, distr <span class='op'>=</span> <span class='st'>"bernoulli"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: bernoulli
#&gt; 
#&gt; data:  MenWoman
#&gt; scan-loglik = 4.6665, p-value = 0.19
#&gt; alternative hypothesis: High
#&gt; sample estimates:
#&gt;                                        
#&gt; Total observations in the MLC =   13.00
#&gt; Expected cases in the MLC =        9.62
#&gt; Observed cases in the MLC =       13.00
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Summary of data:
#&gt; Distribution....................: bernoulli
#&gt; Number of locations.............: 50
#&gt; Total number of cases...........: 50
#&gt; 
#&gt; Scan statistic:
#&gt; Type of cluster (alternative)...: High
#&gt; Value of statisitic (loglik)....: 4.67
#&gt; p-value.........................: 0.19
#&gt; 
#&gt; IDs of cluster detect:
#&gt; Location IDs included..................:  39 35 23 12 41 7 30 16 11 20 25 38 15</div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>scan</span>, sf <span class='op'>=</span> <span class='va'>spain.sf</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Called from: plot.scantest(scan, sf = spain.sf)
#&gt; debug: levels(sf$levels)[levels(sf$levels) == "0"] &lt;- "non-sig"
#&gt; debug: if (z$cases.expect &gt; z$cases.observ) levels(sf$levels)[levels(sf$levels) == 
#&gt;     "1"] &lt;- "sig High"
#&gt; debug: if (z$cases.expect &lt; z$cases.observ) levels(sf$levels)[levels(sf$levels) == 
#&gt;     "2"] &lt;- "sig Low"
#&gt; debug: levels(sf$levels)[levels(sf$levels) == "2"] &lt;- "sig Low"
#&gt; debug: cols &lt;- c(`non-sig` = "white", `sig High` = "red", `sig Low` = "blue")
#&gt; debug: lplot_runs &lt;- ggplot(sf) + geom_sf(aes(fill = levels), color = "black", 
#&gt;     shape = 21, size = mysize) + theme_bw() + theme(axis.text.x = element_blank(), 
#&gt;     axis.text.y = element_blank()) + xlab(paste0("Significance p-value = ", 
#&gt;     z$p.value)) + scale_fill_manual(values = cols, na.value = "orange", 
#&gt;     drop = FALSE)
#&gt; debug: lplot_runs</div><div class='img'><img src='scan.test-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>spain.sf</span>, case<span class='op'>=</span><span class='st'>"men"</span>, nv <span class='op'>=</span> <span class='fl'>5</span>, nsim <span class='op'>=</span> <span class='fl'>99</span>, distr <span class='op'>=</span> <span class='st'>"bernoulli"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: A total of 18 clusters has the same value of the statistic. Report as MLC only the firt</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: bernoulli
#&gt; 
#&gt; data:  MenWoman
#&gt; scan-loglik = 1.6009, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: High
#&gt; sample estimates:
#&gt;                                      
#&gt; Total observations in the MLC =   5.0
#&gt; Expected cases in the MLC =       3.7
#&gt; Observed cases in the MLC =       5.0
#&gt; </div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>scan</span>, sf <span class='op'>=</span> <span class='va'>spain.sf</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Called from: plot.scantest(scan, sf = spain.sf)
#&gt; debug: levels(sf$levels)[levels(sf$levels) == "0"] &lt;- "non-sig"
#&gt; debug: if (z$cases.expect &gt; z$cases.observ) levels(sf$levels)[levels(sf$levels) == 
#&gt;     "1"] &lt;- "sig High"
#&gt; debug: if (z$cases.expect &lt; z$cases.observ) levels(sf$levels)[levels(sf$levels) == 
#&gt;     "2"] &lt;- "sig Low"
#&gt; debug: levels(sf$levels)[levels(sf$levels) == "2"] &lt;- "sig Low"
#&gt; debug: cols &lt;- c(`non-sig` = "white", `sig High` = "red", `sig Low` = "blue")
#&gt; debug: lplot_runs &lt;- ggplot(sf) + geom_sf(aes(fill = levels), color = "black", 
#&gt;     shape = 21, size = mysize) + theme_bw() + theme(axis.text.x = element_blank(), 
#&gt;     axis.text.y = element_blank()) + xlab(paste0("Significance p-value = ", 
#&gt;     z$p.value)) + scale_fill_manual(values = cols, na.value = "orange", 
#&gt;     drop = FALSE)
#&gt; debug: lplot_runs</div><div class='img'><img src='scan.test-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>spain.sf</span>, case<span class='op'>=</span><span class='st'>"men"</span>, nv <span class='op'>=</span> <span class='fl'>15</span>, nsim <span class='op'>=</span> <span class='fl'>99</span>, distr <span class='op'>=</span> <span class='st'>"bernoulli"</span>, windows <span class='op'>=</span><span class='st'>"elliptic"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: A total of 37 clusters has the same value of the statistic. Report as MLC only the firt</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: bernoulli
#&gt; 
#&gt; data:  MenWoman
#&gt; scan-loglik = 5.5629, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: High
#&gt; sample estimates:
#&gt;                                       
#&gt; Total observations in the MLC =   15.0
#&gt; Expected cases in the MLC =       11.1
#&gt; Observed cases in the MLC =        9.0
#&gt; </div><div class='input'><span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>spain.sf</span>, case<span class='op'>=</span><span class='st'>"men"</span>, nv <span class='op'>=</span> <span class='fl'>15</span>, nsim <span class='op'>=</span> <span class='fl'>99</span>, distr <span class='op'>=</span> <span class='st'>"bernoulli"</span>, windows <span class='op'>=</span><span class='st'>"elliptic"</span>, alternative <span class='op'>=</span> <span class='st'>"Low"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: A total of 13 clusters has the same value of the statistic. Report as MLC only the firt</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: bernoulli
#&gt; 
#&gt; data:  MenWoman
#&gt; scan-loglik = 28.653, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: Low
#&gt; sample estimates:
#&gt;                                        
#&gt; Total observations in the MLC =   13.00
#&gt; Expected cases in the MLC =        9.62
#&gt; Observed cases in the MLC =        8.00
#&gt; </div><div class='input'><span class='fu'><a href='methods_scantest.html'>plot.scantest</a></span><span class='op'>(</span><span class='va'>scan</span>, sf <span class='op'>=</span> <span class='va'>spain.sf</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in plot.scantest(scan, sf = spain.sf): could not find function "plot.scantest"</span></div><div class='input'>
<span class='co'># Case 2: scan test multinomial</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span>list <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Spain</span><span class='op'>)</span>
<span class='va'>formula</span> <span class='op'>&lt;-</span> <span class='op'>~</span> <span class='va'>Older65</span>
<span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>spain.sf</span>, nsim <span class='op'>=</span> <span class='fl'>99</span>, distr <span class='op'>=</span> <span class='st'>"multinomial"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: multinomial
#&gt; 
#&gt; data:  Older65
#&gt; scan-loglik = 4.6027, p-value = 0.85
#&gt; sample estimates:
#&gt;               low middle high Sum
#&gt; cases.expect  6.3   7.56 7.14  21
#&gt; cases.observ 10.0   3.00 8.00  21
#&gt; </div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>scan</span>, sf <span class='op'>=</span> <span class='va'>spain.sf</span><span class='op'>)</span>
</div><div class='img'><img src='scan.test-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Case 3: scan test multinomial</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span>list <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>FastFood</span><span class='op'>)</span>
<span class='va'>formula</span> <span class='op'>&lt;-</span> <span class='op'>~</span> <span class='va'>Type</span>
<span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>FastFood.sf</span>, nsim <span class='op'>=</span> <span class='fl'>99</span>, distr <span class='op'>=</span> <span class='st'>"multinomial"</span>, windows<span class='op'>=</span><span class='st'>"elliptic"</span>, nv <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: A total of 5 clusters has the same value of the statistic. Report as MLC only the firt</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: multinomial
#&gt; 
#&gt; data:  Type
#&gt; scan-loglik = 130.94, p-value &lt; 2.2e-16
#&gt; sample estimates:
#&gt;                  H     P     S Sum
#&gt; cases.expect 31.36 34.55 34.09 100
#&gt; cases.observ 42.00 32.00 26.00 100
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Summary of data:
#&gt; Distribution....................: multinomial
#&gt; Number of locations.............: 877
#&gt; Total number of cases...........: 877
#&gt; 
#&gt; Scan statistic:
#&gt; Observed cases in the MLC...: 31.36 34.55 34.09 100
#&gt; Expected cases in the MLC...: 42 32 26 100
#&gt; Value of statisitic (loglik)....: 130.94
#&gt; p-value.........................: 0
#&gt; 
#&gt; IDs of cluster detect:
#&gt; Location IDs included..................:  79 104 92 222 257 246 77 733 642 350 573 124 328 155 75 365 282 109 163 756 125 343 831 80 383 43 446 247 702 806 671 42 665 304 227 133 478 645 619 570 466 657 284 866 488 159 195 346 567 147 382 139 253 830 36 728 683 475 392 541 197 293 209 815 385 268 331 128 107 476 423 286 634 323 210 707 746 432 119 730 149 753 775 2 221 238 768 45 585 630 172 17 411 390 502 73 140 747 499 130</div><div class='input'><span class='fu'><a href='methods_scantest.html'>plot.scantest</a></span><span class='op'>(</span><span class='va'>scan</span>, sf <span class='op'>=</span> <span class='va'>FastFood.sf</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in plot.scantest(scan, sf = FastFood.sf): could not find function "plot.scantest"</span></div><div class='input'>
<span class='co'># Case 4: DGP two categories</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span>list <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>
<span class='va'>cx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>cy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'>knearneigh</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cx</span>,<span class='va'>cy</span><span class='op'>)</span>, k <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>fx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dgp.spq.html'>dgp.spq</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p</span>, listw <span class='op'>=</span> <span class='va'>listw</span>, rho <span class='op'>=</span> <span class='va'>rho</span><span class='op'>)</span>
<span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>fx <span class='op'>=</span> <span class='va'>fx</span>, nsim <span class='op'>=</span> <span class='fl'>9</span>, case <span class='op'>=</span> <span class='st'>"1"</span>, nv <span class='op'>=</span> <span class='fl'>20</span>, coor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cx</span>,<span class='va'>cy</span><span class='op'>)</span>, distr <span class='op'>=</span> <span class='st'>"bernoulli"</span>,windows<span class='op'>=</span><span class='st'>"elliptic"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in match.arg(case, unique(mfx)): 'arg' should be one of "B", "A"</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; function (file = "", what = double(), nmax = -1L, n = -1L, sep = "", 
#&gt;     quote = if (identical(sep, "\n")) "" else "'\"", dec = ".", 
#&gt;     skip = 0L, nlines = 0L, na.strings = "NA", flush = FALSE, 
#&gt;     fill = FALSE, strip.white = FALSE, quiet = FALSE, blank.lines.skip = TRUE, 
#&gt;     multi.line = TRUE, comment.char = "", allowEscapes = FALSE, 
#&gt;     fileEncoding = "", encoding = "unknown", text, skipNul = FALSE) 
#&gt; {
#&gt;     na.strings &lt;- as.character(na.strings)
#&gt;     if (!missing(n)) {
#&gt;         if (missing(nmax)) 
#&gt;             nmax &lt;- n/pmax(length(what), 1L)
#&gt;         else stop("either specify 'nmax' or 'n', but not both.")
#&gt;     }
#&gt;     if (missing(file) &amp;&amp; !missing(text)) {
#&gt;         file &lt;- textConnection(text, encoding = "UTF-8")
#&gt;         encoding &lt;- "UTF-8"
#&gt;         on.exit(close(file))
#&gt;     }
#&gt;     if (is.character(file)) 
#&gt;         if (file == "") 
#&gt;             file &lt;- stdin()
#&gt;         else {
#&gt;             file &lt;- if (nzchar(fileEncoding)) 
#&gt;                 file(file, "r", encoding = fileEncoding)
#&gt;             else file(file, "r")
#&gt;             on.exit(close(file))
#&gt;         }
#&gt;     if (!inherits(file, "connection")) 
#&gt;         stop("'file' must be a character string or connection")
#&gt;     .Internal(scan(file, what, nmax, sep, dec, quote, skip, nlines, 
#&gt;         na.strings, flush, fill, strip.white, quiet, blank.lines.skip, 
#&gt;         multi.line, comment.char, allowEscapes, encoding, skipNul))
#&gt; }
#&gt; &lt;bytecode: 0x0000000045e40c58&gt;
#&gt; &lt;environment: namespace:base&gt;</div><div class='input'><span class='fu'><a href='methods_scantest.html'>plot.scantest</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in plot.scantest(scan): could not find function "plot.scantest"</span></div><div class='input'>
<span class='co'># Case 5: DGP three categories</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span>list <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>cx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>cy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'>knearneigh</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cx</span>,<span class='va'>cy</span><span class='op'>)</span>, k <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>fx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dgp.spq.html'>dgp.spq</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p</span>, listw <span class='op'>=</span> <span class='va'>listw</span>, rho <span class='op'>=</span> <span class='va'>rho</span><span class='op'>)</span>
<span class='va'>scan</span> <span class='op'>&lt;-</span> <span class='fu'>scan.test</span><span class='op'>(</span>fx <span class='op'>=</span> <span class='va'>fx</span>, nsim <span class='op'>=</span> <span class='fl'>19</span>, coor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cx</span>,<span class='va'>cy</span><span class='op'>)</span>, nv <span class='op'>=</span> <span class='fl'>30</span>, distr <span class='op'>=</span> <span class='st'>"multinomial"</span>,windows<span class='op'>=</span><span class='st'>"elliptic"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: A total of 223 clusters has the same value of the statistic. Report as MLC only the firt</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Scan test. Distribution: multinomial
#&gt; 
#&gt; data:  fx
#&gt; scan-loglik = 33.928, p-value &lt; 2.2e-16
#&gt; sample estimates:
#&gt;                  A     B    C Sum
#&gt; cases.expect 10.02  9.99 9.99  30
#&gt; cases.observ  5.00 17.00 8.00  30
#&gt; </div><div class='input'><span class='fu'><a href='methods_scantest.html'>plot.scantest</a></span><span class='op'>(</span><span class='va'>scan</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in plot.scantest(scan): could not find function "plot.scantest"</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Román Minguez Salido, Fernando López Hernandez, Manuel Ruiz Marin, Antonio Páez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


