<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>spqdata user guide • spqdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="spqdata user guide">
<meta property="og:description" content="spqdata">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spqdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.00</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/user_guide.html">spqdata user guide</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paezha/spqdata/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="user_guide_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>spqdata user guide</h1>
            <h3 class="subtitle">The user guide <br><br><br>
</h3>
                        <h4 class="author">Fernando A. López, Technical University of Cartagena (Spain)</h4>
                        <h4 class="author">Román Mínguez, University of Castilla-La Mancha (Spain)</h4>
                        <h4 class="author">Antonio Páez, McMaster University (Canada)</h4>
                        <h4 class="author">Manuel Ruiz, Technical University of Cartagena (Spain) <br><br><br>
</h4>
            
            <h4 class="date">2021-07-04 <br><br><br>
</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paezha/spqdata/blob/master/vignettes/user_guide.Rmd"><code>vignettes/user_guide.Rmd</code></a></small>
      <div class="hidden name"><code>user_guide.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Esta guía está diseñada para mostrar el funcionamiento del paquete <strong>spqdata</strong> para testar dependencia espacial en datos cualitativos</p>
<div id="datos" class="section level2">
<h2 class="hasAnchor">
<a href="#datos" class="anchor"></a>Datos</h2>
<p>En esta guia se usaran dos conjuntos de datos como ejemplos:</p>
<ul>
<li><p><strong>Spain</strong>: La división de España en provincias. Es una geometría de polígonos que tiene <em>islas</em></p></li>
<li><p><strong>FastFood</strong>: El ejemplo de Páez et al en JGS. Es una geometría de puntos</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paezha/spqdata">spqdata</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Spain"</span>, package <span class="op">=</span> <span class="st">"spqdata"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"FastFood"</span>, package <span class="op">=</span> <span class="st">"spqdata"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Se pueden generar datos con estructura espacial</li>
</ul>
</div>
<div id="dgp" class="section level2">
<h2 class="hasAnchor">
<a href="#dgp" class="anchor"></a>DGP</h2>
<p>Es posible generar procesos espaciales con estructura utilizando la función <strong>dgp.spq</strong> de la misma manera que en <span class="citation">Ruiz, López, and Páez (<a href="#ref-Ruiz2012" role="doc-biblioref">2012</a><a href="#ref-Ruiz2012" role="doc-biblioref">a</a>)</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>
<span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spdep/man/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spdep/man/knn2nb.html">knn2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spdep/man/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">listw</span>, p <span class="op">=</span> <span class="va">p</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></code></pre></div>
<p>Un simple plot</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>fx<span class="op">=</span><span class="va">fx</span>,cx<span class="op">=</span><span class="va">cx</span>,cy<span class="op">=</span><span class="va">cy</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cx</span>, y<span class="op">=</span><span class="va">cy</span>, color<span class="op">=</span><span class="va">fx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
<div id="q-test" class="section level1">
<h1 class="hasAnchor">
<a href="#q-test" class="anchor"></a>Q test</h1>
<ul>
<li>El test Q está basado en m-historias</li>
<li>Se pueden observar las m-historias y generarlas con distintos algoritmos</li>
</ul>
<div id="m-historias" class="section level2">
<h2 class="hasAnchor">
<a href="#m-historias" class="anchor"></a>m-historias</h2>
<ul>
<li><p><strong>m.surround</strong> es la función que genera m-historias.</p></li>
<li><p>El output es un objeto de la clase m_surr</p></li>
<li><p>El cálculo de las h-historias con una función específica tiene como principal objetivo que el usuario<br>
analice las características del conjunto de m-historias. Mediante el método  el usuario puede explorar la coherencia de las m-historias.</p></li>
</ul>
<p>Obtain m-surroundings with degree of overlapping r:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span>
<span class="va">r</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">mh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m.surround.html">m.surround</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "m_surr" "list"</code></pre>
</div>
<div id="métodos-para-la-clase-m_surr" class="section level2">
<h2 class="hasAnchor">
<a href="#m%C3%A9todos-para-la-clase-m_surr" class="anchor"></a>Métodos para la clase m_surr</h2>
<p>Hay tres métodos desarrollados para esta clase: print, summary y plot</p>
<ul>
<li><p><strong>print</strong> lista las m-historias</p></li>
<li><p><strong>summary</strong> resumen de las carácterísticas de las m-historias</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Characteristics of m-surrounding:
## 
## Number of m-surrounding (R): 49
## Length of m-surrounding (m): 3
## Number no-symbolized observations: 1
## 
## List of no-symbolized observations:
## 16
## 
## List of the degree overlaping:
##     There are 2 m-surrounding that have intersection with 1 m-surrounding
##     There are 47 m-surrounding that have intersection with 2 m-surrounding
## Mean degree of overlaping: 1.9592</code></pre>
<ul>
<li>
<strong>plot</strong> Muestra la estructura espacial de las m-historias</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mh</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/plot%20mh-1.png" width="700"></p>
<ul>
<li>El argumento <strong>control</strong> permite modificar algunas carácterísticas de la m-historia.</li>
<li>Básicamente con <strong>control</strong> se pueden ‘podar’ m-historias no coherentes.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span> <span class="op">(</span>dtmaxknn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">mh.prune</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m.surround.html">m.surround</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mh.prune</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/plot%20mh%20prune-1.png" width="700"></p>
</div>
<div id="el-test-q" class="section level2">
<h2 class="hasAnchor">
<a href="#el-test-q" class="anchor"></a>El test Q</h2>
<ul>
<li>La función <strong>Q.test</strong> obtiene el test Q desarrolado en <span class="citation">(Ruiz, López, and Páez <a href="#ref-Ruiz2012" role="doc-biblioref">2012</a><a href="#ref-Ruiz2012" role="doc-biblioref">a</a>)</span>
</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<ul>
<li>El output es un objeto de la clase <strong>spqtest</strong>
</li>
<li>Genera una lista con el resultado para símbolos basados en permutaciones (standard) como en combinaciones (equivalent).</li>
</ul>
</div>
<div id="métodos-para-spqtest" class="section level2">
<h2 class="hasAnchor">
<a href="#m%C3%A9todos-para-spqtest" class="anchor"></a>Métodos para spqtest</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">q.test</span><span class="op">)</span></code></pre></div>
<div id="kxdtzwdoda" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#kxdtzwdoda .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kxdtzwdoda .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxdtzwdoda .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kxdtzwdoda .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kxdtzwdoda .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxdtzwdoda .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxdtzwdoda .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kxdtzwdoda .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kxdtzwdoda .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kxdtzwdoda .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kxdtzwdoda .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kxdtzwdoda .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#kxdtzwdoda .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kxdtzwdoda .gt_from_md > :first-child {
  margin-top: 0;
}

#kxdtzwdoda .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kxdtzwdoda .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kxdtzwdoda .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#kxdtzwdoda .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxdtzwdoda .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#kxdtzwdoda .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxdtzwdoda .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kxdtzwdoda .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kxdtzwdoda .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxdtzwdoda .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxdtzwdoda .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#kxdtzwdoda .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxdtzwdoda .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#kxdtzwdoda .gt_left {
  text-align: left;
}

#kxdtzwdoda .gt_center {
  text-align: center;
}

#kxdtzwdoda .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kxdtzwdoda .gt_font_normal {
  font-weight: normal;
}

#kxdtzwdoda .gt_font_bold {
  font-weight: bold;
}

#kxdtzwdoda .gt_font_italic {
  font-style: italic;
}

#kxdtzwdoda .gt_super {
  font-size: 65%;
}

#kxdtzwdoda .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="11" class="gt_heading gt_title gt_font_normal" style>Qualitative Dependence Test (Q)</th>
    </tr>
<tr>
<th colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Distribution: asymptotic. Distance: Euclidean</th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Q</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">k</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">r</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R/n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">5k^m</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="11" class="gt_group_heading">V1 - standard-permutations</td>
    </tr>
<tr>
<td class="gt_row gt_right">97.56</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">0.00000</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">49</td>
<td class="gt_row gt_right">27</td>
<td class="gt_row gt_right">1.81</td>
<td class="gt_row gt_right">135</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="11" class="gt_group_heading">V1 - equivalent-combinations</td>
    </tr>
<tr>
<td class="gt_row gt_right">28.39</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">0.00082</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">49</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">4.90</td>
<td class="gt_row gt_right">135</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">q.test</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="user_guide_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<pre><code>## [[1]]</code></pre>
<p><img src="user_guide_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="user_guide_files/figure-html/unnamed-chunk-8-4.png" width="700"></p>
</div>
<div id="el-test-q-para-un-objeto-sf" class="section level2">
<h2 class="hasAnchor">
<a href="#el-test-q-para-un-objeto-sf" class="anchor"></a>El test Q para un objeto sf</h2>
<ul>
<li>El input de <strong>Q.test</strong> puede también ser un objeto sf o un dataframe</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Case 3: With a sf object with isolated areas</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Spain"</span><span class="op">)</span>
<span class="va">f1</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">MenWoman</span>
<span class="va">q.test.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">spain.sf</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<ul>
<li>El método </li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">q.test.sf</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="user_guide_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<pre><code>## [[1]]</code></pre>
<p><img src="user_guide_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="user_guide_files/figure-html/unnamed-chunk-10-4.png" width="700"></p>
</div>
</div>
<div id="qmap-test" class="section level1">
<h1 class="hasAnchor">
<a href="#qmap-test" class="anchor"></a>QMap test</h1>
<ul>
<li><p>Test <strong>QMap</strong> publicado en <span class="citation">Ruiz, López, and Páez (<a href="#ref-Ruiz2012b" role="doc-biblioref">2012</a><a href="#ref-Ruiz2012b" role="doc-biblioref">b</a>)</span></p></li>
<li><p>La función <strong>Q.map.test</strong> obtiene el test QMap</p></li>
</ul>
<div id="el-test-qmap" class="section level2">
<h2 class="hasAnchor">
<a href="#el-test-qmap" class="anchor"></a>El test QMap</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>
<span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">QY1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span>
<span class="va">rho</span> <span class="op">=</span> <span class="fl">0.8</span>
<span class="va">QY2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">QY1</span>,<span class="va">QY2</span><span class="op">)</span>
<span class="va">m</span> <span class="op">=</span> <span class="fl">3</span>
<span class="va">r</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">QY1</span> <span class="op">+</span> <span class="va">QY2</span>
<span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>dtmaxknn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">qmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.map.test.html">Q.map.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">dt</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span>, type <span class="op">=</span><span class="st">"combinations"</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in Q.map.test(formula = formula, data = dt, coor = coor, m = m, : The
## ratio between the number of symbolized observations and the number of symbols is
## lower than 5.</code></pre>
<ul>
<li>El output de la función <strong>Q.Map</strong> es un objeto de la clase <strong>qmap</strong> y <strong>htest</strong>
</li>
</ul>
</div>
<div id="métodos-para-clase-qmap" class="section level2">
<h2 class="hasAnchor">
<a href="#m%C3%A9todos-para-clase-qmap" class="anchor"></a>Métodos para clase qmap</h2>
<ul>
<li>El objeto qmap es una lista con dos elementos. Cada elemento es un objeto de la clase <strong>htext</strong>
</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">qmap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Q-Map test of Equivalence for qualitative data.
##  
##  Symbols type: combinations
##  
##  Ratio Symbolized observations/Num symbols = 4.6
## 
## data:  QY1 and QY2
## QE = 149.42, df = 9, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided</code></pre>
<ul>
<li>El método <strong>plot</strong> obtiene la distribución de simbolos con los intervalos de confianza especificados por el usuario.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qmap</span>, ci<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
<div id="runs-tests" class="section level1">
<h1 class="hasAnchor">
<a href="#runs-tests" class="anchor"></a>Runs tests</h1>
<div id="global-runs-test" class="section level2">
<h2 class="hasAnchor">
<a href="#global-runs-test" class="anchor"></a>Global Runs test</h2>
<ul>
<li>La función <strong>sp.runs.test</strong> obtiene el test de rachas espacial</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spdep/man/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">srq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sp.runs.test.html">sp.runs.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, listw <span class="op">=</span> <span class="va">listw</span><span class="op">)</span></code></pre></div>
<ul>
<li>El output es un objeto de las clases <strong>sprunstest</strong> y <strong>htest</strong>
</li>
</ul>
</div>
<div id="metodos-para-clase-spruntest" class="section level2">
<h2 class="hasAnchor">
<a href="#metodos-para-clase-spruntest" class="anchor"></a>Metodos para clase spruntest</h2>
<ul>
<li>Hay implementados dos métodos para objetos de esta clase:  y </li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">srq</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Runs test of spatial dependence for qualitative data. Asymptotic
##  version
## 
## data:  mxf
## sp.runs test = -1.0763, p-value = 0.2818
## alternative hypothesis: two.sided
## sample estimates:
##          Total runs     Mean total runs Variance total runs 
##            273.0000            285.5152            135.1986</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">srq</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="local-runs-test" class="section level2">
<h2 class="hasAnchor">
<a href="#local-runs-test" class="anchor"></a>Local Runs test</h2>
<ul>
<li>La función <strong>local.sp.runs.test</strong> calcula los test locales basadps en rachas</li>
</ul>
</div>
<div id="local-runs-test-asintótico" class="section level2">
<h2 class="hasAnchor">
<a href="#local-runs-test-asint%C3%B3tico" class="anchor"></a>Local Runs test asintótico</h2>
<ul>
<li>Version asintótica</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lsrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/local.sp.runs.test.html">local.sp.runs.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, listw <span class="op">=</span> <span class="va">listw</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></code></pre></div>
<ul>
<li>El método <strong>print</strong> lista los estadísticos</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">lsrq</span><span class="op">)</span></code></pre></div>
<pre><code>##     runs.i      E.i     Std.i    z.value    p.value
## 1        3 2.855152 0.8722689  0.1660594 0.56594492
## 2        4 2.855152 0.8722689  1.3124950 0.90532341
## 3        1 2.855152 0.8722689 -2.1268116 0.01671787
## 4        3 2.855152 0.8722689  0.1660594 0.56594492
## 5        3 2.855152 0.8722689  0.1660594 0.56594492
## 6        3 2.855152 0.8722689  0.1660594 0.56594492
## 7        3 2.855152 0.8722689  0.1660594 0.56594492
## 8        2 2.855152 0.8722689 -0.9803761 0.16345026
## 9        3 2.855152 0.8722689  0.1660594 0.56594492
## 10       4 2.855152 0.8722689  1.3124950 0.90532341
## 11       3 2.855152 0.8722689  0.1660594 0.56594492
## 12       4 2.855152 0.8722689  1.3124950 0.90532341
## 13       2 2.855152 0.8722689 -0.9803761 0.16345026
## 14       2 2.855152 0.8722689 -0.9803761 0.16345026
## 15       3 2.855152 0.8722689  0.1660594 0.56594492
## 16       1 2.855152 0.8722689 -2.1268116 0.01671787
## 17       2 2.855152 0.8722689 -0.9803761 0.16345026
## 18       4 2.855152 0.8722689  1.3124950 0.90532341
## 19       4 2.855152 0.8722689  1.3124950 0.90532341
## 20       3 2.855152 0.8722689  0.1660594 0.56594492
## 21       2 2.855152 0.8722689 -0.9803761 0.16345026
## 22       4 2.855152 0.8722689  1.3124950 0.90532341
## 23       4 2.855152 0.8722689  1.3124950 0.90532341
## 24       1 2.855152 0.8722689 -2.1268116 0.01671787
## 25       4 2.855152 0.8722689  1.3124950 0.90532341
## 26       4 2.855152 0.8722689  1.3124950 0.90532341
## 27       1 2.855152 0.8722689 -2.1268116 0.01671787
## 28       2 2.855152 0.8722689 -0.9803761 0.16345026
## 29       4 2.855152 0.8722689  1.3124950 0.90532341
## 30       3 2.855152 0.8722689  0.1660594 0.56594492
## 31       3 2.855152 0.8722689  0.1660594 0.56594492
## 32       3 2.855152 0.8722689  0.1660594 0.56594492
## 33       3 2.855152 0.8722689  0.1660594 0.56594492
## 34       3 2.855152 0.8722689  0.1660594 0.56594492
## 35       2 2.855152 0.8722689 -0.9803761 0.16345026
## 36       1 2.855152 0.8722689 -2.1268116 0.01671787
## 37       2 2.855152 0.8722689 -0.9803761 0.16345026
## 38       3 2.855152 0.8722689  0.1660594 0.56594492
## 39       3 2.855152 0.8722689  0.1660594 0.56594492
## 40       1 2.855152 0.8722689 -2.1268116 0.01671787
## 41       3 2.855152 0.8722689  0.1660594 0.56594492
## 42       2 2.855152 0.8722689 -0.9803761 0.16345026
## 43       3 2.855152 0.8722689  0.1660594 0.56594492
## 44       2 2.855152 0.8722689 -0.9803761 0.16345026
## 45       4 2.855152 0.8722689  1.3124950 0.90532341
## 46       3 2.855152 0.8722689  0.1660594 0.56594492
## 47       3 2.855152 0.8722689  0.1660594 0.56594492
## 48       2 2.855152 0.8722689 -0.9803761 0.16345026
## 49       3 2.855152 0.8722689  0.1660594 0.56594492
## 50       3 2.855152 0.8722689  0.1660594 0.56594492
## 51       4 2.855152 0.8722689  1.3124950 0.90532341
## 52       1 2.855152 0.8722689 -2.1268116 0.01671787
## 53       2 2.855152 0.8722689 -0.9803761 0.16345026
## 54       3 2.855152 0.8722689  0.1660594 0.56594492
## 55       1 2.855152 0.8722689 -2.1268116 0.01671787
## 56       1 2.855152 0.8722689 -2.1268116 0.01671787
## 57       3 2.855152 0.8722689  0.1660594 0.56594492
## 58       3 2.855152 0.8722689  0.1660594 0.56594492
## 59       3 2.855152 0.8722689  0.1660594 0.56594492
## 60       3 2.855152 0.8722689  0.1660594 0.56594492
## 61       2 2.855152 0.8722689 -0.9803761 0.16345026
## 62       4 2.855152 0.8722689  1.3124950 0.90532341
## 63       4 2.855152 0.8722689  1.3124950 0.90532341
## 64       2 2.855152 0.8722689 -0.9803761 0.16345026
## 65       2 2.855152 0.8722689 -0.9803761 0.16345026
## 66       1 2.855152 0.8722689 -2.1268116 0.01671787
## 67       4 2.855152 0.8722689  1.3124950 0.90532341
## 68       3 2.855152 0.8722689  0.1660594 0.56594492
## 69       3 2.855152 0.8722689  0.1660594 0.56594492
## 70       4 2.855152 0.8722689  1.3124950 0.90532341
## 71       3 2.855152 0.8722689  0.1660594 0.56594492
## 72       1 2.855152 0.8722689 -2.1268116 0.01671787
## 73       3 2.855152 0.8722689  0.1660594 0.56594492
## 74       4 2.855152 0.8722689  1.3124950 0.90532341
## 75       2 2.855152 0.8722689 -0.9803761 0.16345026
## 76       2 2.855152 0.8722689 -0.9803761 0.16345026
## 77       4 2.855152 0.8722689  1.3124950 0.90532341
## 78       2 2.855152 0.8722689 -0.9803761 0.16345026
## 79       4 2.855152 0.8722689  1.3124950 0.90532341
## 80       2 2.855152 0.8722689 -0.9803761 0.16345026
## 81       3 2.855152 0.8722689  0.1660594 0.56594492
## 82       4 2.855152 0.8722689  1.3124950 0.90532341
## 83       3 2.855152 0.8722689  0.1660594 0.56594492
## 84       2 2.855152 0.8722689 -0.9803761 0.16345026
## 85       2 2.855152 0.8722689 -0.9803761 0.16345026
## 86       1 2.855152 0.8722689 -2.1268116 0.01671787
## 87       1 2.855152 0.8722689 -2.1268116 0.01671787
## 88       3 2.855152 0.8722689  0.1660594 0.56594492
## 89       4 2.855152 0.8722689  1.3124950 0.90532341
## 90       4 2.855152 0.8722689  1.3124950 0.90532341
## 91       2 2.855152 0.8722689 -0.9803761 0.16345026
## 92       3 2.855152 0.8722689  0.1660594 0.56594492
## 93       4 2.855152 0.8722689  1.3124950 0.90532341
## 94       3 2.855152 0.8722689  0.1660594 0.56594492
## 95       4 2.855152 0.8722689  1.3124950 0.90532341
## 96       2 2.855152 0.8722689 -0.9803761 0.16345026
## 97       4 2.855152 0.8722689  1.3124950 0.90532341
## 98       2 2.855152 0.8722689 -0.9803761 0.16345026
## 99       3 2.855152 0.8722689  0.1660594 0.56594492
## 100      1 2.855152 0.8722689 -2.1268116 0.01671787</code></pre>
<ul>
<li>El método <strong>plot</strong> identifica las localizaciones con test significativos</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">lsrq</span>, sig <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div id="local-runs-test-boots" class="section level2">
<h2 class="hasAnchor">
<a href="#local-runs-test-boots" class="anchor"></a>Local Runs test boots</h2>
<ul>
<li>Version boot (permutaciones) con un objeto sf</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Spain</span><span class="op">)</span>
<span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spdep/man/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">spain.sf</span>,<span class="st">"Spatial"</span><span class="op">)</span>, queen <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">spain.sf</span><span class="op">[</span><span class="st">"MenWoman"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">MenWoman</span>
<span class="co"># Boots Version</span>
<span class="va">lsrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/local.sp.runs.test.html">local.sp.runs.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">spain.sf</span>, listw <span class="op">=</span> <span class="va">listw</span>, distr <span class="op">=</span><span class="st">"bootstrap"</span>, nsim <span class="op">=</span> <span class="fl">199</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">lsrq</span>, sf <span class="op">=</span> <span class="va">spain.sf</span>, sig <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-2.png" width="700"></p>
</div>
</div>
<div id="scan-test" class="section level1">
<h1 class="hasAnchor">
<a href="#scan-test" class="anchor"></a>scan test</h1>
<ul>
<li><p>De la familia de test scan para identificar clusters definidos para distintas distribuciones hay dos que se aplican a procesos espaciales de tipo cualitativo</p></li>
<li><p>El output es un objeto de las clases <strong>scantest</strong> y <strong>htest</strong></p></li>
<li><p>Ver <span class="citation">Kanaroglou (<a href="#ref-Kanaroglou2016" role="doc-biblioref">2016</a>)</span></p></li>
<li><p>El test no necesita la matriz W</p></li>
<li><p>El test contrasta la nula de independencia pero añade información adicional señalando uno o varios clústeres con distribición espacial diferencial del resto.</p></li>
<li><p>No tiene distribución asintótica. La significatividad se obtiene por remuestreo permutacional</p></li>
</ul>
<div id="scan-bernoulli" class="section level2">
<h2 class="hasAnchor">
<a href="#scan-bernoulli" class="anchor"></a>scan bernoulli</h2>
<ul>
<li>Para porcesos espaciales con dos categorías</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">MenWoman</span>
<span class="va">scan.spain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">spain.sf</span>, case<span class="op">=</span><span class="st">"men"</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scan.spain</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Scan test. Distribution: bernoulli
## 
## data:  MenWoman
## scan-loglik = 4.6665, p-value = 0.19
## alternative hypothesis: High
## sample estimates:
##                                        
## Total observations in the MLC =   13.00
## Expected cases in the MLC =        9.62
## Observed cases in the MLC =       13.00</code></pre>
</div>
<div id="scan-multinomial" class="section level2">
<h2 class="hasAnchor">
<a href="#scan-multinomial" class="anchor"></a>scan multinomial</h2>
<ul>
<li>Para porcesos espaciales con tres o más categorías</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">FastFood</span><span class="op">)</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span>
<span class="va">scan.fastfood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"multinomial"</span>, windows<span class="op">=</span><span class="st">"elliptic"</span>, nv <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in scan.test(formula = formula, data = FastFood.sf, nsim = 99, distr
## = "multinomial", : A total of 5 clusters has the same value of the statistic.
## Report as MLC only the firt</code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scan.fastfood</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Scan test. Distribution: multinomial
## 
## data:  Type
## scan-loglik = 130.94, p-value &lt; 2.2e-16
## sample estimates:
##                  H     P     S Sum
## cases.expect 31.36 34.55 34.09 100
## cases.observ 42.00 32.00 26.00 100</code></pre>
</div>
<div id="metodos-scan" class="section level2">
<h2 class="hasAnchor">
<a href="#metodos-scan" class="anchor"></a>metodos scan</h2>
<ul>
<li>Hay dos métodos para aplicar a objetos <strong>scantest</strong>
</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">scan.fastfood</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Summary of data:
## Distribution....................: multinomial
## Number of locations.............: 877
## Total number of cases...........: 877
## 
## Scan statistic:
## Observed cases in the MLC...: 31.36 34.55 34.09 100
## Expected cases in the MLC...: 42 32 26 100
## Value of statisitic (loglik)....: 130.94
## p-value.........................: 0
## 
## IDs of cluster detect:
## Location IDs included..................:  79 104 92 222 257 246 77 733 642 350 573 124 328 155 75 365 282 109 163 756 125 343 831 80 383 43 446 247 702 806 671 42 665 304 227 133 478 645 619 570 466 657 284 866 488 159 195 346 567 147 382 139 253 830 36 728 683 475 392 541 197 293 209 815 385 268 331 128 107 476 423 286 634 323 210 707 746 432 119 730 149 753 775 2 221 238 768 45 585 630 172 17 411 390 502 73 140 747 499 130</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">scan.spain</span>, sf <span class="op">=</span> <span class="va">spain.sf</span><span class="op">)</span></code></pre></div>
<pre><code>## Called from: plot.scantest(scan.spain, sf = spain.sf)
## debug: levels(sf$levels)[levels(sf$levels) == "0"] &lt;- "non-sig"
## debug: if (z$cases.expect &gt; z$cases.observ) levels(sf$levels)[levels(sf$levels) == 
##     "1"] &lt;- "sig High"
## debug: if (z$cases.expect &lt; z$cases.observ) levels(sf$levels)[levels(sf$levels) == 
##     "2"] &lt;- "sig Low"
## debug: levels(sf$levels)[levels(sf$levels) == "2"] &lt;- "sig Low"
## debug: cols &lt;- c(`non-sig` = "white", `sig High` = "red", `sig Low` = "blue")
## debug: lplot_runs &lt;- ggplot(sf) + geom_sf(aes(fill = levels), color = "black", 
##     shape = 21, size = mysize) + theme_bw() + theme(axis.text.x = element_blank(), 
##     axis.text.y = element_blank()) + xlab(paste0("Significance p-value = ", 
##     z$p.value)) + scale_fill_manual(values = cols, na.value = "orange", 
##     drop = FALSE)
## debug: lplot_runs</code></pre>
<p><img src="user_guide_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot.scantest(scan.fastfood, sf = FastFood.sf)</span></code></pre></div>
</div>
</div>
<div id="similarity-test" class="section level1">
<h1 class="hasAnchor">
<a href="#similarity-test" class="anchor"></a>Similarity test</h1>
<p>El papel de <span class="citation">Farber, Marin, and Páez (<a href="#ref-Farber2014" role="doc-biblioref">2014</a>)</span> desarrolla un test de similaridad</p>
<div id="test-de-similaridad" class="section level2">
<h2 class="hasAnchor">
<a href="#test-de-similaridad" class="anchor"></a>Test de similaridad</h2>
<p>la función similarity.test calcula el test de similaridad tanto para distribición asintótica como por remuestreo permutacional.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">$</span><span class="va">Lon</span>,<span class="va">FastFood.sf</span><span class="op">$</span><span class="va">Lat</span><span class="op">)</span>
<span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spdep/man/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span>
<span class="va">similarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.test.html">similarity.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, listw <span class="op">=</span> <span class="va">listw</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">similarity</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Similarity test of spatial dependence for qualitative data.
##  Distribution: asymptotic
## 
## data:  Type
## Similarity-test = -5.4476, p-value = 5.105e-08
## alternative hypothesis: two.sided</code></pre>
</div>
</div>
<div id="join-count-test" class="section level1">
<h1 class="hasAnchor">
<a href="#join-count-test" class="anchor"></a>Join-count test</h1>
<ul>
<li>Se ha <strong>wrapeado</strong> las funciones de <strong>spdep</strong> para distribuciones bernoulli y multinomial. Se pueden utilizar distribuciones asintóticas o Monte Carlo (permutaciones)</li>
</ul>
<div id="distribución-asintótica" class="section level2">
<h2 class="hasAnchor">
<a href="#distribuci%C3%B3n-asint%C3%B3tica" class="anchor"></a>distribución asintótica</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f1</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Older65</span> <span class="op">+</span> <span class="va">MenWoman</span>
<span class="va">jc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jc.test.html">jc.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">spain.sf</span>, distr <span class="op">=</span> <span class="st">"asymptotic"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">jc1</span><span class="op">)</span></code></pre></div>
<div id="sindhvxbvh" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#sindhvxbvh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sindhvxbvh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sindhvxbvh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sindhvxbvh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sindhvxbvh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sindhvxbvh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sindhvxbvh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sindhvxbvh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sindhvxbvh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sindhvxbvh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sindhvxbvh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sindhvxbvh .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#sindhvxbvh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sindhvxbvh .gt_from_md > :first-child {
  margin-top: 0;
}

#sindhvxbvh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sindhvxbvh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sindhvxbvh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#sindhvxbvh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sindhvxbvh .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#sindhvxbvh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sindhvxbvh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sindhvxbvh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sindhvxbvh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sindhvxbvh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sindhvxbvh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#sindhvxbvh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sindhvxbvh .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#sindhvxbvh .gt_left {
  text-align: left;
}

#sindhvxbvh .gt_center {
  text-align: center;
}

#sindhvxbvh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sindhvxbvh .gt_font_normal {
  font-weight: normal;
}

#sindhvxbvh .gt_font_bold {
  font-weight: bold;
}

#sindhvxbvh .gt_font_italic {
  font-style: italic;
}

#sindhvxbvh .gt_super {
  font-size: 65%;
}

#sindhvxbvh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>JoinCount Spatial Tests (asymptotic)</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">pairs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">z-value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Joincount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Expected</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Variance</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="6" class="gt_group_heading">Older65 - multinomial - alternative: greater - Join count test under nonfree sampling</td>
    </tr>
<tr>
<td class="gt_row gt_left">high:high</td>
<td class="gt_row gt_right">−0.33</td>
<td class="gt_row gt_right">0.62827</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">13.96</td>
<td class="gt_row gt_right">8.69</td>
</tr>
<tr>
<td class="gt_row gt_left">low:low</td>
<td class="gt_row gt_right">−0.67</td>
<td class="gt_row gt_right">0.74783</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">10.78</td>
<td class="gt_row gt_right">7.12</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:middle</td>
<td class="gt_row gt_right">−1.21</td>
<td class="gt_row gt_right">0.88596</td>
<td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">15.71</td>
<td class="gt_row gt_right">9.48</td>
</tr>
<tr>
<td class="gt_row gt_left">low:high</td>
<td class="gt_row gt_right">−0.05</td>
<td class="gt_row gt_right">0.51838</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">26.18</td>
<td class="gt_row gt_right">15.96</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:high</td>
<td class="gt_row gt_right">−1.27</td>
<td class="gt_row gt_right">0.89830</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">31.42</td>
<td class="gt_row gt_right">18.16</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:low</td>
<td class="gt_row gt_right">−0.67</td>
<td class="gt_row gt_right">0.74805</td>
<td class="gt_row gt_right">25</td>
<td class="gt_row gt_right">27.72</td>
<td class="gt_row gt_right">16.62</td>
</tr>
<tr>
<td class="gt_row gt_left">Jtot</td>
<td class="gt_row gt_right">−1.34</td>
<td class="gt_row gt_right">0.91040</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right">85.33</td>
<td class="gt_row gt_right">38.45</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="6" class="gt_group_heading">MenWoman - binomial - alternative: greater - Join count test under nonfree sampling</td>
    </tr>
<tr>
<td class="gt_row gt_left">men-men</td>
<td class="gt_row gt_right">−2.17</td>
<td class="gt_row gt_right">0.98504</td>
<td class="gt_row gt_right">60</td>
<td class="gt_row gt_right">68.39</td>
<td class="gt_row gt_right">14.92</td>
</tr>
<tr>
<td class="gt_row gt_left">woman-woman</td>
<td class="gt_row gt_right">2.11</td>
<td class="gt_row gt_right">0.01740</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">8.01</td>
<td class="gt_row gt_right">5.59</td>
</tr>
<tr>
<td class="gt_row gt_left">men-woman</td>
<td class="gt_row gt_right">−2.47</td>
<td class="gt_row gt_right">0.99333</td>
<td class="gt_row gt_right">38</td>
<td class="gt_row gt_right">49.39</td>
<td class="gt_row gt_right">21.19</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="distribución-monte-carlo" class="section level2">
<h2 class="hasAnchor">
<a href="#distribuci%C3%B3n-monte-carlo" class="anchor"></a>distribución Monte Carlo</h2>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jc.test.html">jc.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">spain.sf</span>, distr <span class="op">=</span> <span class="st">"mc"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">jc1</span><span class="op">)</span></code></pre></div>
<div id="asbabveish" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#asbabveish .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#asbabveish .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#asbabveish .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#asbabveish .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#asbabveish .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#asbabveish .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#asbabveish .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#asbabveish .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#asbabveish .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#asbabveish .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#asbabveish .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#asbabveish .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#asbabveish .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#asbabveish .gt_from_md > :first-child {
  margin-top: 0;
}

#asbabveish .gt_from_md > :last-child {
  margin-bottom: 0;
}

#asbabveish .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#asbabveish .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#asbabveish .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#asbabveish .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#asbabveish .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#asbabveish .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#asbabveish .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#asbabveish .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#asbabveish .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#asbabveish .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#asbabveish .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#asbabveish .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#asbabveish .gt_left {
  text-align: left;
}

#asbabveish .gt_center {
  text-align: center;
}

#asbabveish .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#asbabveish .gt_font_normal {
  font-weight: normal;
}

#asbabveish .gt_font_bold {
  font-weight: bold;
}

#asbabveish .gt_font_italic {
  font-style: italic;
}

#asbabveish .gt_super {
  font-size: 65%;
}

#asbabveish .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>JoinCount Spatial Tests (Monte Carlo)</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">pairs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Joincount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Expected</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Variance</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="5" class="gt_group_heading">Older65 - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)</td>
    </tr>
<tr>
<td class="gt_row gt_left">high:high</td>
<td class="gt_row gt_right">0.39400</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">12.29</td>
<td class="gt_row gt_right">9.39</td>
</tr>
<tr>
<td class="gt_row gt_left">low:low</td>
<td class="gt_row gt_right">0.54000</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">9.54</td>
<td class="gt_row gt_right">7.40</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:middle</td>
<td class="gt_row gt_right">0.69000</td>
<td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">13.82</td>
<td class="gt_row gt_right">10.68</td>
</tr>
<tr>
<td class="gt_row gt_left">low:high</td>
<td class="gt_row gt_right">0.19500</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">23.13</td>
<td class="gt_row gt_right">14.91</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:high</td>
<td class="gt_row gt_right">0.65500</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">27.83</td>
<td class="gt_row gt_right">17.05</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:low</td>
<td class="gt_row gt_right">0.40700</td>
<td class="gt_row gt_right">25</td>
<td class="gt_row gt_right">24.38</td>
<td class="gt_row gt_right">16.71</td>
</tr>
<tr>
<td class="gt_row gt_left">Jtot</td>
<td class="gt_row gt_right">0.34200</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right">75.35</td>
<td class="gt_row gt_right">22.70</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="5" class="gt_group_heading">MenWoman - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic</td>
    </tr>
<tr>
<td class="gt_row gt_left">men-men</td>
<td class="gt_row gt_right">0.51650</td>
<td class="gt_row gt_right">60</td>
<td class="gt_row gt_right">60.41</td>
<td class="gt_row gt_right">22.68</td>
</tr>
<tr>
<td class="gt_row gt_left">woman-woman</td>
<td class="gt_row gt_right">0.02400</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">7.01</td>
<td class="gt_row gt_right">6.32</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Farber2014">
<p>Farber, Steven, Manuel Ruiz Marin, and Antonio Páez. 2014. “Testing for Spatial Independence Using Similarity Relations.” <em>Geographical Analysis</em> 47 (2): 97–120. <a href="https://doi.org/10.1111/gean.12044">https://doi.org/10.1111/gean.12044</a>.</p>
</div>
<div id="ref-Kanaroglou2016">
<p>Kanaroglou, Pavlos. 2016. <em>Spatial Analysis in Health Geography</em>. Routledge. <a href="https://doi.org/10.4324/9781315610252">https://doi.org/10.4324/9781315610252</a>.</p>
</div>
<div id="ref-Ruiz2012">
<p>Ruiz, Manuel, Fernando López, and Antonio Páez. 2012a. “Comparison of Thematic Maps Using Symbolic Entropy.” <em>International Journal of Geographical Information Science</em> 26 (3): 413–39. <a href="https://doi.org/10.1080/13658816.2011.586327">https://doi.org/10.1080/13658816.2011.586327</a>.</p>
</div>
<div id="ref-Ruiz2012b">
<p>———. 2012b. “Comparison of Thematic Maps Using Symbolic Entropy.” <em>International Journal of Geographical Information Science</em> 26 (3): 413–39. <a href="https://doi.org/10.1080/13658816.2011.586327">https://doi.org/10.1080/13658816.2011.586327</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Román Minguez Salido, Fernando López Hernandez, Manuel Ruiz Marin, Antonio Páez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
